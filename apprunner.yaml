version: 1.0
runtime: nodejs18
build:
  commands:
    pre-build:
      - apt-get update
      - apt-get install -y git
      - git clone https://github.com/slyfox1186/ffmpeg-build-script.git
      - cd ffmpeg-build-script
      - bash build-ffmpeg.sh --build --enable-gpl-and-non-free --latest
      - ls
      - cd ..
    build:
      - npm install
run:
  command: npm start
  network:
    port: 8000
    env: MY_APP_PORT
  env:
    - name: CACHE_NAME
      value: video
    - name: ENVIRONMENT
      value: production
  secrets:
    - name: MOMENTO_API_KEY
      value-from: momento
